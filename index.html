<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Gerador de Holerite Profissional</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
body {
  font-family: "Segoe UI", Arial, sans-serif;
  background: linear-gradient(180deg, #e6f0ff, #f8fafc);
  margin: 0;
  padding: 0;
}
.container {
  max-width: 900px;
  background: white;
  margin: 40px auto;
  padding: 30px 40px;
  border-radius: 12px;
  box-shadow: 0 0 20px rgba(0,0,0,0.1);
}
h1 {
  text-align: center;
  color: #003366;
  margin-bottom: 25px;
}
label {
  font-weight: bold;
  display: block;
  margin-top: 10px;
}
input {
  width: 100%;
  padding: 8px;
  border-radius: 6px;
  border: 1px solid #ccc;
  margin-top: 5px;
  font-size: 15px;
}
button {
  margin-top: 25px;
  width: 100%;
  background: #004999;
  color: white;
  border: none;
  padding: 14px;
  border-radius: 10px;
  font-size: 16px;
  cursor: pointer;
}
button:hover { background: #003366; }
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 15px 20px;
  margin-top: 10px;
}
</style>
</head>
<body>
  <div class="container">
    <h1>Gerador de Holerite em PDF</h1>
    <div class="grid">
      <div><label>Nome do Funcion√°rio</label><input id="nome"></div>
      <div><label>M√™s/Ano de Refer√™ncia</label><input id="mes"></div>
      <div><label>Sal√°rio Base (R$)</label><input type="number" id="salario" step="0.01"></div>
      <div><label>Dias √öteis do m√™s</label><input type="number" id="diasUteis"></div>
      <div><label>Dias Trabalhados (c√≥d. 011)</label><input type="number" id="diasTrab"></div>
      <div><label>Horas Trabalhadas (m√™s)</label><input type="number" id="horasTrab"></div>
      <div><label>Dias D.S.R (c√≥d. 049)</label><input type="number" id="dsr"></div>
      <div><label>Horas Noturnas 20% (c√≥d. 050)</label><input type="number" id="noturno"></div>
      <div><label>Horas Extra 50% (c√≥d. 060)</label><input type="number" id="extra50"></div>
      <div><label>Horas Extra 100% (c√≥d. 061)</label><input type="number" id="extra100"></div>
      <div><label>Domingos/Feriados (c√≥d. 062)</label><input type="number" id="feriado"></div>
      <div><label>Dias Vale-Transporte</label><input type="number" id="diasVT"></div>
      <div><label>Valor Passagem (ida + volta)</label><input type="number" id="vp" step="0.01"></div>
    </div>
    <button onclick="gerarPDF()">Gerar Holerite PDF</button>
  </div>

<script>
function calcularINSS(s) {
  if (s <= 1518) return { valor: s * 0.075, aliq: 7.5 };
  if (s <= 2793.88) return { valor: 1518 * 0.075 + (s - 1518) * 0.09, aliq: 9 };
  if (s <= 4190.83)
    return { valor: 1518 * 0.075 + (2793.88 - 1518) * 0.09 + (s - 2793.88) * 0.12, aliq: 12 };
  return {
    valor: 1518 * 0.075 + (2793.88 - 1518) * 0.09 + (4190.83 - 2793.88) * 0.12 + (s - 4190.83) * 0.14,
    aliq: 14
  };
}
function fmt(v) { return "R$ " + v.toFixed(2).replace(".", ","); }

function gerarPDF() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  const nome = document.getElementById("nome").value.trim() || "Funcion√°rio";
  const mes = document.getElementById("mes").value.trim() || "00/0000";
  const sal = parseFloat(document.getElementById("salario").value) || 0;
  const du = parseFloat(document.getElementById("diasUteis").value) || 1;
  const dt = parseFloat(document.getElementById("diasTrab").value) || 0;
  const ht = parseFloat(document.getElementById("horasTrab").value) || 1;
  const dsr = parseFloat(document.getElementById("dsr").value) || 0;
  const hn = parseFloat(document.getElementById("noturno").value) || 0;
  const he50 = parseFloat(document.getElementById("extra50").value) || 0;
  const he100 = parseFloat(document.getElementById("extra100").value) || 0;
  const fer = parseFloat(document.getElementById("feriado").value) || 0;
  const dvt = parseFloat(document.getElementById("diasVT").value) || 0;
  const vp = parseFloat(document.getElementById("vp").value) || 0;

  const vdt = sal / 30, vhn = vdt / ht;
  const v011 = vdt * dt;
  const v050 = (vhn * 0.2) * hn;
  const v060 = vhn * he50 * 1.5;
  const v061 = vhn * he100 * 2;
  const v062 = fer * 101.20;
  const v049 = ((v050 + v060 + v061 + v062) / du) * dsr;
  const vtInd = dvt * vp;
  const vtDesc = v011 * 0.06;
  const inss = calcularINSS(sal);

  const totalProv = v011 + v049 + v050 + v060 + v061 + v062 + vtInd;
  const totalDesc = inss.valor + vtDesc;
  const liquido = totalProv - totalDesc;

  // Cabe√ßalho
  doc.setFont("helvetica", "bold");
  doc.setFontSize(16);
  doc.text("Holerite de Pagamento", 105, 15, null, null, "center");
  doc.setFontSize(11);
  doc.text(`Funcion√°rio: ${nome}`, 15, 25);
  doc.text(`Refer√™ncia: ${mes}`, 15, 32);
  doc.line(15, 35, 195, 35);

  // Tabela de 4 colunas
  let y = 43;
  doc.setFont("helvetica", "bold");
  doc.text("Descri√ß√£o", 17, y);
  doc.text("Refer√™ncia", 87, y);
  doc.text("Provento (R$)", 137, y);
  doc.text("Desconto (R$)", 177, y);
  y += 6;

  function linha(desc, ref, prov, descv) {
    doc.setFont("helvetica", "normal");
    doc.text(desc, 17, y);
    doc.text(ref, 92, y);
    if (prov > 0) doc.text(fmt(prov), 150, y, null, null, "right");
    if (descv > 0) doc.text(fmt(descv), 190, y, null, null, "right");
    y += 6;
  }

  // Proventos
  linha("Sal√°rio Base (011)", `${dt} dias`, v011, 0);
  linha("Descanso Semanal (049)", `${dsr} dias`, v049, 0);
  linha("Adicional Noturno 20% (050)", `${hn} h`, v050, 0);
  linha("Hora Extra 50% (060)", `${he50} h`, v060, 0);
  linha("Hora Extra 100% (061)", `${he100} h`, v061, 0);
  linha("Domingo/Feriado (062)", `${fer} dias`, v062, 0);
  linha("Indeniza√ß√£o VT (100)", `${dvt} dias`, vtInd, 0);
  // Descontos
  linha(`INSS (310) ${inss.aliq}%`, "", 0, inss.valor);
  linha("Vale Transporte (320) 6%", "", 0, vtDesc);

  y += 6;
  doc.setFont("helvetica", "bold");
  doc.text(`Total de Proventos: ${fmt(totalProv)}`, 15, y);
  y += 6;
  doc.text(`Total de Descontos: ${fmt(totalDesc)}`, 15, y);
  y += 10;
  doc.line(15, y - 4, 195, y - 4);
  doc.text(`üí∞ Total L√≠quido a Receber: ${fmt(liquido)}`, 15, y);

  const nomeArq = `${nome.replace(/\s+/g, "_")}_holerite_${mes.replace("/", "-")}.pdf`;
  doc.save(nomeArq);
}
</script>
</body>
</html>
